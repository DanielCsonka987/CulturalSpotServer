(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{83:function(e,t,n){},89:function(e,t,n){},92:function(e,t,n){"use strict";n.r(t);var r=n(3),s=n(60),a=n.n(s),c=(n(83),n(12)),o=n(15),i=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,97)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),s(e),a(e),c(e)}))},l=n(9),u=n(16),j=n(27),d=n(96),b=n(28),p=function(e){return Date.now()+1e3*e},O=n(61),g=function(e,t){var n,r={field:[],message:[]},s=Object(O.a)(t);try{for(s.s();!(n=s.n()).done;){var a=n.value,c=x[a](e);c&&(r.field.push(a),r.message.push(c))}}catch(o){s.e(o)}finally{s.f()}return r},h=new RegExp("[a-zA-Z0-9_ ]{4,}"),f=new RegExp(".{6,}"),m=new RegExp("^[a-z0-9._]{3,}@[a-z]{3,}.{1}[a-z]{2,3}$"),x={email:function(e){var t=e.email.split(".").reverse();return t[0].length<2||t[0].length>3?"Not acceptable email!":m.test(e.email)?"":"Not acceptable email!"},username:function(e){return e.username.length>50?"Too long username!":h.test(e.username)?"":"Not acceptable username!"},password:function(e){return f.test(e.password)?"":"Not acceptable password!"},passwordconf:function(e){return e.password===e.passwordconf&&f.test(e.passwordconf)?"":"Not acceptable password confirmation!"}};var v=function(e){var t,n=e.split(".");return(24!==(t=n[0]).length||new RegExp(/[a-f0-9]{24}/).test(t))&&n[1]&&n[2]&&n[3]};function w(e,t){for(var n=0;n<e.length;n++)localStorage.setItem(e[n],t[n])}function E(){!function(e){for(var t=0;t<e.length;t++)localStorage.removeItem(e[t])}(["authToken","refreshToken","expireDate"])}var C,k=n(0),y={user:null,newContent:[]},S=Object(b.a)(C||(C=Object(j.a)(["\n    query requireClientContent{\n        requireClientContent{\n            id, email, username, registeredAt, lastLoggedAt\n        }\n    }\n    "]))),L=Object(r.createContext)({user:null,newContent:[],srvErrMessage:"",backPageURL:"",login:function(e){},logout:function(){},setSrvError:function(e){},setBackPageURL:function(e){}});function T(e,t){switch(t.type){case"LOGIN":return Object(c.a)(Object(c.a)({},e),{},{user:t.payload});case"LOGOUT":return Object(c.a)(Object(c.a)({},e),{},{user:null,newContent:[]});case"ERROR":return Object(c.a)(Object(c.a)({},e),{},{srvErrMessage:t.payload});case"URL":return Object(c.a)(Object(c.a)({},e),{},{backPageURL:t.payload});default:return e}}function P(e){var t=Object(r.useReducer)(T,y),n=Object(u.a)(t,2),s=n[0],a=n[1],c=Object(d.a)(S,{onCompleted:function(e){a({type:"LOGIN",payload:e.requireClientContent})},onError:function(e){console.log(e.message)}}),o=Object(u.a)(c,2),i=o[0],l=o[1].called;return Object(r.useEffect)((function(){!function(){var e={refreshToken:localStorage.getItem("refreshToken"),token:localStorage.getItem("authToken"),expireDate:localStorage.getItem("expireDate")};return!Object.values(e).includes(null)&&e}()||s.user||l||i()})),Object(k.jsx)(L.Provider,{value:{user:s.user,newContent:s.newContent,srvErrMessage:s.srvErrMessage,backPageURL:s.backPageURL,login:function(e){!function(e){w(["authToken","refreshToken","expireDate"],[e.token,e.refreshToken,p(e.tokenExpire)])}(e),delete e.token,delete e.tokenExpire,delete e.refreshToken,a({type:"LOGIN",payload:e})},logout:function(){E(),a({type:"LOGOUT"})},setSrvError:function(e){a({type:"ERROR",payload:e})},setBackPageURL:function(e){a({type:"URL",payload:e})}},children:e.children})}var R=n(95),U=n(40),D=function(e,t){var n=Object(r.useState)(e),s=Object(u.a)(n,2),a=s[0],o=s[1];return{values:a,onSubmit:function(e){e.preventDefault(),t()},onChange:function(e){o(Object(c.a)(Object(c.a)({},a),{},Object(U.a)({},e.target.name,e.target.value)))},clearFields:function(){o(e)}}},I=function(){var e=Object(r.useState)({errfields:[],errmsgs:[]}),t=Object(u.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)({msg:""}),o=Object(u.a)(a,2),i=o[0],l=o[1];return{feedbacks:Object(c.a)(Object(c.a)({},n),i),setValidationErrors:function(e){s(Object(U.a)({errors:e.field},"errors",e.message))},setGeneralMessage:function(e){l({msg:e})},setGeneralError:function(e){s({errfields:[],errmsgs:e})},resetErrors:function(){s({errfields:[],errmsgs:[]})},resetMessage:function(){l({msg:""})},resetFeedbacks:function(){s({errfields:[],errmsgs:[]}),l({msg:""})}}},F=function(e,t){var n=Object(l.g)(),s=Object(r.useContext)(L);(s.user&&"LOGOUT_NEEDED"===e||!s.user&&"LOGIN_NEEDED"===e)&&n.push(t)};var G,N=function(e){var t=e.labeling,n=e.type,r=e.name,s=e.value,a=e.funcChange,c=e.invalidInputs.errfields.includes(r);return Object(k.jsxs)("label",{children:[t,c?"**":"",Object(k.jsx)("input",{type:n,value:s,name:r,onChange:a})]})},$=function(e){var t=e.text;return Object(k.jsx)("p",{children:t})};var A,_=Object(b.a)(G||(G=Object(j.a)(["\n    mutation login(\n        $email: String!\n        $password: String!\n    ){\n        login(\n            email: $email\n            password: $password\n        ){\n            id, email, username, token, tokenExpire, refreshToken, registeredAt, lastLoggedAt\n        }\n    }\n"]))),M=function(){F("LOGOUT_NEEDED","/");var e=["email","password"],t=I(),n=t.feedbacks,s=t.setValidationErrors,a=t.setGeneralError,c=t.resetErrors,i=D({email:"",password:""},(function(){c();var t=g(j,e);0===t.field.length?f():s(t)})),j=i.values,d=i.onSubmit,b=i.onChange,p=Object(r.useContext)(L),O=Object(R.a)(_,{update:function(e,t){var n=t.data.login;p.login(n),c()},onError:function(e){console.log(e),a(e.message)},variables:j}),h=Object(u.a)(O,2),f=h[0],m=h[1].loading;return Object(k.jsxs)("div",{children:[Object(k.jsx)("h3",{children:"Login page"}),p.user?Object(k.jsx)(l.a,{to:"/"}):Object(k.jsx)(k.Fragment,{}),Object(k.jsxs)("form",{children:[Object(k.jsx)(N,{labeling:"Email",type:"text",invalidInputs:n,name:"email",value:j.email,funcChange:b}),Object(k.jsx)(N,{labeling:"Password",type:"password",invalidInputs:n,name:"password",value:j.password,funcChange:b}),Object(k.jsx)("input",{type:"submit",value:"Login",onClick:d}),m&&Object(k.jsx)("p",{children:"Under process..."}),n.errmsgs.length>0&&n.errmsgs.map((function(e,t){return Object(k.jsx)($,{text:e},t)}))]}),Object(k.jsx)("p",{children:Object(k.jsx)(o.b,{to:"/passwordresetting/email",children:"Did you forget the password?"})})]})};var B,q=Object(b.a)(A||(A=Object(j.a)(["\n    mutation registration(\n        $email: String!,\n        $username: String!,\n        $password: String!,\n        $passwordconf: String!\n    ){\n        registration(\n            email: $email,\n            username: $username,\n            password: $password,\n            passwordconf: $passwordconf\n        ){\n            id, email, username, token, tokenExpire, refreshToken, registeredAt, lastLoggedAt\n        }\n    }\n"]))),z=function(){F("LOGOUT_NEEDED","/");var e=["email","username","password","passwordconf"],t=D({email:"",username:"",password:"",passwordconf:""},(function(){d();var t=g(n,e);0===t.field.length?h():i(t)})),n=t.values,s=t.onSubmit,a=t.onChange,c=I(),o=c.feedbacks,i=c.setValidationErrors,j=c.setGeneralError,d=c.resetErrors,b=Object(r.useContext)(L),p=Object(R.a)(q,{update:function(e,t){var n=t.data.registration;b.login(n),d()},onError:function(e){console.log(e),j(e.message)},variables:n}),O=Object(u.a)(p,2),h=O[0],f=O[1].loading;return Object(k.jsxs)("div",{children:[Object(k.jsx)("h3",{children:"Registration"}),b.user?Object(k.jsx)(l.a,{to:"/"}):Object(k.jsx)(k.Fragment,{}),Object(k.jsx)("p",{children:"Please fill this form with some registration details."}),Object(k.jsxs)("form",{children:[Object(k.jsx)(N,{labeling:"Email",type:"email",invalidInputs:o,name:"email",value:n.email,funcChange:a}),Object(k.jsx)(N,{labeling:"Username",type:"text",invalidInputs:o,name:"username",value:n.username,funcChange:a}),Object(k.jsx)(N,{labeling:"Password",type:"password",invalidInputs:o,name:"password",value:n.password,funcChange:a}),Object(k.jsx)(N,{labeling:"Confrim password",type:"password",invalidInputs:o,name:"passwordconf",value:n.passwordconf,funcChange:a}),Object(k.jsx)("input",{type:"submit",value:"Send",onClick:s}),f&&Object(k.jsx)("p",{children:"Under process..."}),o.errmsgs.length>0&&o.errmsgs.map((function(e,t){return Object(k.jsx)($,{text:e},t)}))]})]})};var V,H=function(){F("LOGOUT_NEEDED","/");var e=["email"],t=I(),n=t.feedbacks,r=t.setValidationErrors,s=t.setGeneralMessage,a=t.setGeneralError,c=t.resetErrors,o=t.resetFeedbacks,i=D({email:""},(function(){o();var t=g(l,e);0===t.field.length?h():r(t)})),l=i.values,j=i.onSubmit,d=i.onChange,b=i.clearFields,p=Object(R.a)(J,{update:function(e,t){var n=t.data.resetPasswordStep1;b(),c(),s(n.resultText+" Please check out your email account for continuing the process!")},onError:function(e){console.log(e),a(e.message)},variables:l}),O=Object(u.a)(p,2),h=O[0],f=O[1].loading;return Object(k.jsxs)("div",{children:[Object(k.jsx)("h4",{children:"Forgotten password resetting - sending authenticator email"}),Object(k.jsx)("p",{children:"For resetting forgotten password, please give your email which you have been registered to the site!"}),Object(k.jsx)("p",{children:"You will get an email with a link URL, with which you can continue the forgotten password resetting process."}),Object(k.jsxs)("form",{children:[Object(k.jsx)(N,{labeling:"Email",type:"email",invalidInputs:n,name:"email",value:l.email,funcChange:d}),Object(k.jsx)("input",{type:"submit",value:"Continue",onClick:j}),f&&Object(k.jsx)("p",{children:"Under process..."}),n.errmsgs.length>0&&n.errmsgs.map((function(e,t){return Object(k.jsx)($,{text:e},t)})),n.msg&&Object(k.jsx)("p",{children:n.msg})]})]})},J=Object(b.a)(B||(B=Object(j.a)(["\n    mutation resetPasswordStep1(\n        $email: String!\n    ){\n        resetPasswordStep1(\n            email: $email\n        ){\n            resultText, id, email, username    \n        }\n    }\n"])));var W=function(){F("LOGOUT_NEEDED","/"),function(e,t){var n=Object(r.useContext)(L),s=Object(l.g)(),a=document.cookie;if(a){var c=a.split(";").find((function(e){return e.startsWith("srverror=")})).split("=")[1];if(c){var o=c.split("_").join(" ");n.setSrvError(o),t&&(n.setBackPageURL(t),s.replace(t)),s.push(e)}}}("/error","/passwordresetting/email");var e=Object(l.g)(),t=Object(l.i)();v(t.token)||e.push("/");var n=["password","passwordconf"],s=I(),a=s.feedbacks,c=s.setValidationErrors,o=s.setGeneralError,i=s.resetErrors,j=D({password:"",passwordconf:""},(function(){i();var e=g(d,n);0===e.field.length?m():c(e)})),d=j.values,b=j.onSubmit,p=j.onChange,O=j.clearFields,h=Object(R.a)(Y,{update:function(t,n){n.data.resetPasswordStep3;i(),O(),e.replace("/passwordresetting/result")},onError:function(e){console.log(e),o(e.message)},variables:d,context:{headers:{resetting:t.token}}}),f=Object(u.a)(h,2),m=f[0],x=f[1].loading;return Object(k.jsxs)("div",{children:[Object(k.jsx)("h4",{children:"Forgotten password resetting - new password setting"}),Object(k.jsx)("p",{children:"Please give a new password to your account and its repeat as confirmation!."}),Object(k.jsxs)("form",{children:[Object(k.jsx)(N,{labeling:"New Password",type:"password",invalidInputs:a,name:"password",value:d.password,funcChange:p}),Object(k.jsx)(N,{labeling:"Confirm password",type:"password",invalidInputs:a,name:"passwordconf",value:d.passwordConfirm,funcChange:p}),Object(k.jsx)("input",{type:"submit",value:"Change password",onClick:b}),x&&Object(k.jsx)("p",{children:"Under process..."}),a.errmsgs.length>0&&a.errmsgs.map((function(e,t){return Object(k.jsx)($,{text:e},t)}))]})]})},Y=Object(b.a)(V||(V=Object(j.a)(["\n    mutation resetPasswordStep3(\n        $password: String!\n        $passwordconf: String!\n    ){\n        resetPasswordStep3(\n            newpassword: $password,\n            newconf: $passwordconf\n        ){\n            resultText, id, email, username    \n        }\n    }\n"])));var Z=function(){return F("LOGOUT_NEEDED","/"),Object(k.jsxs)("div",{children:[Object(k.jsx)("h4",{children:"Your Forgotten Password has been resetted!"}),Object(k.jsx)("p",{children:"A minute later you can use your new password!"})]})};var K=function(){var e=Object(l.j)(),t=e.path,n=e.url;return Object(k.jsxs)("div",{children:[Object(k.jsx)("h3",{children:"Forgotten password resetting page"}),Object(k.jsxs)(l.d,{children:[Object(k.jsx)(l.b,{path:"".concat(t,"/email"),children:Object(k.jsx)(H,{})}),Object(k.jsx)(l.b,{path:"".concat(t,"/result"),children:Object(k.jsx)(Z,{})}),Object(k.jsx)(l.b,{path:"".concat(t,"/:token"),children:Object(k.jsx)(W,{})}),Object(k.jsx)(l.a,{from:"".concat(n),to:"/"})]})]})};var Q=function(){return Object(k.jsx)("div",{children:"Wellcome this site!"})};var X=function(){var e=Object(r.useContext)(L);return Object(r.useEffect)((function(){e.logout()})),Object(k.jsx)(l.a,{to:"/"})};var ee=function(){return Object(k.jsx)("div",{children:Object(k.jsx)("h3",{children:"Review content"})})};var te=function(){return Object(k.jsx)("div",{children:Object(k.jsx)("h3",{children:"Chattings"})})};var ne=function(){return Object(k.jsx)("div",{children:Object(k.jsx)("h3",{children:"Account dashboard"})})};var re=function(){return Object(k.jsx)("div",{children:Object(k.jsx)("h3",{children:"Friends"})})};var se=function(){return Object(k.jsx)("div",{children:Object(k.jsx)("h3",{children:"Posts"})})};var ae=function(){var e=Object(r.useContext)(L),t=Object(l.g)(),n=function(n){n.preventDefault(),"Homepage"===n.target.value&&t.push("/"),"Back"===n.target.value&&t.push(e.backPageURL)};return Object(k.jsxs)("div",{children:[Object(k.jsx)("h4",{children:"Something went wrong!"}),Object(k.jsx)("p",{children:e.srvErrMessage}),Object(k.jsx)("input",{type:"submit",value:"Homepage",onClick:n}),Object(k.jsx)("input",{type:"submit",value:"Back",onClick:n})]})};var ce=function(){var e=Object(r.useContext)(L);return Object(k.jsx)(k.Fragment,{children:e.user?Object(k.jsxs)(l.d,{children:[Object(k.jsx)(l.b,{path:"/logout",component:X}),Object(k.jsx)(l.b,{path:"/account",component:ne}),Object(k.jsx)(l.b,{path:"/friends",component:re}),Object(k.jsx)(l.b,{path:"/posts",component:se}),Object(k.jsx)(l.b,{path:"/chats",component:te}),Object(k.jsx)(l.b,{path:"/",component:ee})]}):Object(k.jsxs)(l.d,{children:[Object(k.jsx)(l.b,{exact:!0,path:"/login",component:M}),Object(k.jsx)(l.b,{exact:!0,path:"/registration",component:z}),Object(k.jsx)(l.b,{path:"/passwordresetting",component:K}),Object(k.jsx)(l.b,{path:"/error",component:ae}),Object(k.jsx)(l.b,{path:"/",component:Q})]})})};var oe=function(){var e=Object(r.useContext)(L),t=Object(l.h)().pathname.split("/"),n=Object(u.a)(t,1)[0],s=Object(r.useState)({active:n.toLowerCase()}),a=Object(u.a)(s,2);return a[0],a[1],Object(k.jsx)("nav",{children:e.user?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("li",{children:Object(k.jsx)(o.b,{to:"/account",children:"My account"})}),Object(k.jsx)("li",{children:Object(k.jsx)(o.b,{to:"/friends",children:"Friends"})}),Object(k.jsx)("li",{children:Object(k.jsx)(o.b,{to:"/posts",children:"Posts"})}),Object(k.jsx)("li",{children:Object(k.jsx)(o.b,{to:"/chats",children:"Chatting"})}),Object(k.jsx)("li",{children:Object(k.jsx)(o.b,{to:"/logout",children:"Logout"})})]}):Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("li",{children:Object(k.jsx)(o.b,{to:"/login",children:"Login"})}),Object(k.jsx)("li",{children:Object(k.jsx)(o.b,{to:"/registration",children:"Registration"})})]})})};n(89);var ie=function(){return Object(r.useEffect)((function(){i()})),Object(k.jsxs)("div",{className:"App",children:[Object(k.jsx)("header",{className:"App-header",children:Object(k.jsx)("h1",{children:"Cultural Spot"})}),Object(k.jsx)(P,{children:Object(k.jsxs)(o.a,{children:[Object(k.jsx)(oe,{}),Object(k.jsx)(ce,{})]})})]})},le=n(68),ue=n(71),je=n(22),de=n(72),be=n(94),pe=Object(de.a)({uri:"http://localhost:4040/graphql"}),Oe=new je.a((function(e,t){return e.getContext("refreshing")&&e.setContext((function(e){var t=e.headers,n=void 0===t?{}:t;return{headers:Object(c.a)(Object(c.a)({},n),{},{refreshing:localStorage.getItem("refreshToken")||null})}})),e.setContext((function(e){var t=e.headers,n=void 0===t?{}:t;return{headers:Object(c.a)(Object(c.a)({},n),{},{authorization:"Bearer "+(localStorage.getItem("authToken")||"")})}})),t(e)})),ge=new le.a({link:Object(je.c)([Oe,pe]),cache:new ue.a}),he=Object(k.jsx)(be.a,{client:ge,children:Object(k.jsx)(ie,{})});a.a.render(he,document.getElementById("root")),i()}},[[92,1,2]]]);
//# sourceMappingURL=main.8b9374a8.chunk.js.map